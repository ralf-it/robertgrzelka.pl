<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses - Robert Grzelka</title><meta name=author content="Robert Grzelka"><meta name=author-link content="https://robertgrzelka.pl"><meta name=description content="In my another article we described a Private Endpoints for VNET Integrated Ingress. Today we will talk about Public Network Firewall Access Control from VNET Subnets and IP Addresses.
In today&rsquo;s digital age, within the vast ecosystem of Azure, security stands out as one of the most pressing concerns for developers and system administrators alike. As organizations increasingly migrate their assets to the cloud, ensuring their protection becomes an absolute necessity."><meta name=keywords content="Azure,VNET,Subnet,IP Address,Public Network Access,Firewall,DevOps,Key Vault"><meta itemprop=name content="Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses"><meta itemprop=description content="In my another article we described a Private Endpoints for VNET Integrated Ingress. Today we will talk about Public Network Firewall Access Control from VNET Subnets and IP Addresses.
In today&rsquo;s digital age, within the vast ecosystem of Azure, security stands out as one of the most pressing concerns for developers and system administrators alike. As organizations increasingly migrate their assets to the cloud, ensuring their protection becomes an absolute necessity."><meta itemprop=datePublished content="2023-10-02T00:00:00+00:00"><meta itemprop=dateModified content="2023-10-08T15:58:25+02:00"><meta itemprop=wordCount content="1411"><meta itemprop=image content="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png"><meta itemprop=keywords content="Azure,VNET,Subnet,IP Address,Public Network Access,Firewall,DevOps,Key Vault,"><meta property="og:title" content="Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses"><meta property="og:description" content="In my another article we described a Private Endpoints for VNET Integrated Ingress. Today we will talk about Public Network Firewall Access Control from VNET Subnets and IP Addresses.
In today&rsquo;s digital age, within the vast ecosystem of Azure, security stands out as one of the most pressing concerns for developers and system administrators alike. As organizations increasingly migrate their assets to the cloud, ensuring their protection becomes an absolute necessity."><meta property="og:type" content="article"><meta property="og:url" content="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/"><meta property="og:image" content="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-10-02T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-08T15:58:25+02:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png"><meta name=twitter:title content="Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses"><meta name=twitter:description content="In my another article we described a Private Endpoints for VNET Integrated Ingress. Today we will talk about Public Network Firewall Access Control from VNET Subnets and IP Addresses.
In today&rsquo;s digital age, within the vast ecosystem of Azure, security stands out as one of the most pressing concerns for developers and system administrators alike. As organizations increasingly migrate their assets to the cloud, ensuring their protection becomes an absolute necessity."><meta name=application-name content="Robert Grzelka"><meta name=apple-mobile-web-app-title content="Robert Grzelka"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=https://robertgrzelka.pl/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://robertgrzelka.pl/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://robertgrzelka.pl/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://robertgrzelka.pl/apple-touch-icon.png><link rel=mask-icon href=https://robertgrzelka.pl/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=https://robertgrzelka.pl/site.webmanifest><link rel=canonical href=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/><link rel=prev href=https://robertgrzelka.pl/blog/azure/azure-private-endpoint/><link rel=next href=https://robertgrzelka.pl/blog/azure/azure-devops-variables/><link rel=stylesheet href=https://robertgrzelka.pl/css/style.min.5cfeaf8911dfae16e7f27b76edd66baf359e1c0a2e8272da365e5b1bc1b59dcf.css integrity="sha256-XP6viRHfrhbn8nt27dZrrzWeHAougnLaNl5bG8G1nc8="><link rel=stylesheet href=https://robertgrzelka.pl/lib/fontawesome-free/all.min.01b035efb5dfa529c512f82962ed633328222da6f33c224244806d4798c67349.css integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k="><link rel=stylesheet href=https://robertgrzelka.pl/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/robertgrzelka.pl\/blog\/azure\/azure-public-network-firewall-access-control\/"},"image":[{"@type":"ImageObject","url":"https:\/\/robertgrzelka.pl\/blog\/azure\/azure-public-network-firewall-access-control\/images\/2023-10-07-04-19-53.png","width":848,"height":256}],"genre":"posts","keywords":"Azure, VNET, Subnet, IP Address, Public Network Access, Firewall, DevOps, Key Vault","wordcount":1411,"url":"https:\/\/robertgrzelka.pl\/blog\/azure\/azure-public-network-firewall-access-control\/","datePublished":"2023-10-02T00:00:00+00:00","dateModified":"2023-10-08T15:58:25+02:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"RobertGrzelka","logo":{"@type":"ImageObject","url":"https:\/\/robertgrzelka.pl\/images\/avatar.png","width":394,"height":407}},"author":{"@type":"Person","name":"Robert Grzelka"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=narrow><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=https://robertgrzelka.pl/ title="Robert Grzelka"><img loading=lazy src=https://robertgrzelka.pl/ralf-it.min.svg srcset="https://robertgrzelka.pl///ralf-it.min.svg, /ralf-it.min.svg 1.5x, https://robertgrzelka.pl///ralf-it.min.svg 2x" sizes=auto data-title="Robert Grzelka" data-alt="Robert Grzelka" class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Robert Grzelka</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class="menu-item active has-children"><a class=menu-link href=https://robertgrzelka.pl/blog/ title=Blog><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Blog</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class="menu-item active"><a class=menu-link href=https://robertgrzelka.pl/blog/azure/ title=Azure><i class="fa-solid fa-server fa-fw fa-sm" aria-hidden=true></i> Azure</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/blog/devops/ title="Learn to create a Hugo FixIt site in minutes."><i class="fa-solid fa-infinity fa-fw fa-sm" aria-hidden=true></i> DevOps</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/blog/kubernetes/ title=kubernetes><i class="fa-solid fa-circle-nodes fa-fw fa-sm" aria-hidden=true></i> Kubernetes</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/blog/markdown/ title=markdown><i class="fa-brands fa-readme fa-fw fa-sm" aria-hidden=true></i> Markdown</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/blog/others/ title=others><i class="fa-regular fa-circle-question fa-fw fa-sm" aria-hidden=true></i> Others</a></li></ul></li><li class="menu-item has-children"><a class=menu-link href=https://robertgrzelka.pl/about/><i class="fa-solid fa-info-circle text-success fa-fw fa-sm" aria-hidden=true></i> About</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=https://www.credly.com/users/robert-grzelka/badges rel="noopener noreferrer" target=_blank><i class="fa-solid fa-fire text-danger fa-fw fa-sm" aria-hidden=true></i> Credly</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=https://robertgrzelka.pl/ title="Robert Grzelka"><img loading=lazy src=https://robertgrzelka.pl/ralf-it.min.svg srcset="https://robertgrzelka.pl/ralf-it.min.svg, https://robertgrzelka.pl/ralf-it.min.svg 1.5x, https://robertgrzelka.pl/ralf-it.min.svg 2x" sizes=auto data-title=/ralf-it.min.svg data-alt=/ralf-it.min.svg class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>Robert Grzelka</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></li><li class="menu-item active"><span class=nested-item><a class=menu-link href=https://robertgrzelka.pl/blog/ title=Blog><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Blog</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class="menu-item active"><a class=menu-link href=https://robertgrzelka.pl/blog/azure/ title=Azure><i class="fa-solid fa-server fa-fw fa-sm" aria-hidden=true></i> Azure</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/blog/devops/ title="Learn to create a Hugo FixIt site in minutes."><i class="fa-solid fa-infinity fa-fw fa-sm" aria-hidden=true></i> DevOps</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/blog/kubernetes/ title=kubernetes><i class="fa-solid fa-circle-nodes fa-fw fa-sm" aria-hidden=true></i> Kubernetes</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/blog/markdown/ title=markdown><i class="fa-brands fa-readme fa-fw fa-sm" aria-hidden=true></i> Markdown</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/blog/others/ title=others><i class="fa-regular fa-circle-question fa-fw fa-sm" aria-hidden=true></i> Others</a></li></ul></li><li class=menu-item><span class=nested-item><a class=menu-link href=https://robertgrzelka.pl/about/><i class="fa-solid fa-info-circle text-success fa-fw fa-sm" aria-hidden=true></i> About</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=https://robertgrzelka.pl/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=https://www.credly.com/users/robert-grzelka/badges rel="noopener noreferrer" target=_blank><i class="fa-solid fa-fire text-danger fa-fw fa-sm" aria-hidden=true></i> Credly</a></li><li class="menu-item text-center"><a class=menu-link href=https://github.com/ralf-it/hugo-ralf-it title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item><a href=https://robertgrzelka.pl/blog/ title="The Blog.">Blog</a></li><li class=breadcrumb-item><a href=https://robertgrzelka.pl/blog/azure/ title=Azure>Azure</a></li><li class="breadcrumb-item active" aria-current=page>Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses</li></ol></nav><main class="container container-reverse"><aside class=toc id=toc-auto><h2 class=toc-title>Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside><aside class=aside-custom><div class=right style=max-width:100%;padding-left:10%;padding-right:5%;padding-top:5%><div class="home-profile text-center"><div class=home-avatar><a href=https://robertgrzelka.pl/about title=Blog><img loading=lazy src=https://robertgrzelka.pl/images/avatar.png srcset="https://robertgrzelka.pl///images/avatar.png, /images/avatar.png 1.5x, https://robertgrzelka.pl///images/avatar.png 2x" sizes=auto data-title="Robert Grzelka" data-alt="Robert Grzelka" height=150px style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)' data-h></a></div><h1 class=home-title>Robert Grzelka</h1><h2 class=home-subtitle><span class=d-none>Building Bridges in the Digital Realm: Where Code Meets Infrastructure</span>
<span id=typeit-profile-subtitle class=typeit></span></h2><div class=links><a href=https://github.com/xxxx title=GitHub target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-brands fa-github-alt fa-fw" aria-hidden=true></i>
</a><a href=https://linkedin.com/in/rgr91 title=LinkedIn target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-brands fa-linkedin fa-fw" aria-hidden=true></i>
</a><a href=https://twitter.com/xxxx title=Twitter target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i>
</a><a href=https://www.instagram.com/xxxx title=Instagram target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-brands fa-instagram fa-fw" aria-hidden=true></i>
</a><a href=https://facebook.com/xxxx title=facebook target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-brands fa-facebook fa-fw" aria-hidden=true></i>
</a><a href=https://t.me/xxxx title=Telegram target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-brands fa-telegram-plane fa-fw" aria-hidden=true></i>
</a><a href=https://www.youtube.com/user/xxxx title=YouTube target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-brands fa-youtube fa-fw" aria-hidden=true></i>
</a><a href=https://mastodon.technology/@xxxx title=Mastodon target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-brands fa-mastodon fa-fw" aria-hidden=true></i>
</a><a href=mailto:xxxx@xxxx.com title=Email rel=me><i class="fa-regular fa-envelope fa-fw" aria-hidden=true></i>
</a><a href=https://robertgrzelka.pl/index.xml title=RSS target=_blank rel="external nofollow noopener noreferrer me"><i class="fa-solid fa-rss fa-fw" aria-hidden=true></i></a></div><h3 class=home-disclaimer>robert.grzelka@ralf-it.com</h3></div><aside class="sidebar right-sidebar sticky"><section class="widget tagCloud"><h2 class="widget-title section-title"><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i>&nbsp;
Categories</h2><div class=tagCloud-tags><a href=https://robertgrzelka.pl/categories/guides/ class=font_size_20>Guides (8)</a>
<a href=https://robertgrzelka.pl/categories/blog/ class=font_size_18>Blog (7)</a>
<a href=https://robertgrzelka.pl/categories/advanced/ class=font_size_8>Advanced (3)</a>
<a href=https://robertgrzelka.pl/categories/basics/ class=font_size_5>Basics (2)</a></div></section><section class="widget tagCloud"><h2 class="widget-title section-title"><i class="fa-solid fa-tag fa-fw" aria-hidden=true></i>&nbsp;
Tags</h2><div class=tagCloud-tags><a href=https://robertgrzelka.pl/tags/devops/ class=font_size_20>DevOps
(6)</a>
<a href=https://robertgrzelka.pl/tags/azure-dns/ class=font_size_14>Azure DNS
(4)</a>
<a href=https://robertgrzelka.pl/tags/dns/ class=font_size_14>DNS
(4)</a>
<a href=https://robertgrzelka.pl/tags/firewall/ class=font_size_14>Firewall
(4)</a>
<a href=https://robertgrzelka.pl/tags/acme/ class=font_size_10>ACME
(3)</a>
<a href=https://robertgrzelka.pl/tags/azure/ class=font_size_10>Azure
(3)</a>
<a href=https://robertgrzelka.pl/tags/lets-encrypt/ class=font_size_10>Let's Encrypt
(3)</a>
<a href=https://robertgrzelka.pl/tags/ssl/ class=font_size_10>SSL
(3)</a>
<a href=https://robertgrzelka.pl/tags/tls/ class=font_size_10>TLS
(3)</a>
<a href=https://robertgrzelka.pl/tags/cert-manager/ class=font_size_7>Cert-Manager
(2)</a></div></section></aside></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://robertgrzelka.pl title=Author target=_blank rel="external nofollow noopener noreferrer author" class=author><img loading=lazy src="https://www.gravatar.com/avatar/16cf583881177c457480eb20310b910b?s=32&amp;d=mp" srcset="https://www.gravatar.com/avatar/16cf583881177c457480eb20310b910b?s=32&amp;d=mp, https://www.gravatar.com/avatar/16cf583881177c457480eb20310b910b?s=32&amp;d=mp 1.5x, https://www.gravatar.com/avatar/16cf583881177c457480eb20310b910b?s=32&amp;d=mp 2x" sizes=auto data-title="Robert Grzelka" data-alt="Robert Grzelka" class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;Robert Grzelka</a></span>
<span class=post-category>included in <a href=https://robertgrzelka.pl/categories/blog/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Blog</a>&ensp;<a href=https://robertgrzelka.pl/categories/guides/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Guides</a>&ensp;<a href=https://robertgrzelka.pl/categories/basics/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Basics</a></span></div><div class=post-meta-line><span title="published on 2023-10-02 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2023-10-02>2023-10-02</time></span>&nbsp;<span title="Updated on 2023-10-08 15:58:25"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2023-10-08>2023-10-08</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>1411 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>7 minutes</span>&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title="Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses">
<i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=busuanzi_value_page_pv>-</span>&nbsp;views
</span>&nbsp;</div></div><div class=featured-image><img loading=lazy src=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png srcset="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png 1.5x, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png 2x" sizes=auto data-title=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png data-alt=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-04-19-53.png style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#allow-public-network-access-from-all-networks>Allow public network access from all networks</a></li><li><a href=#disable-public-network-access>Disable public network access</a></li><li><a href=#control-public-network-access>Control public network access</a><ul><li><a href=#why-control-access>Why Control Access?</a></li><li><a href=#access-control-using-vnet-subnets>Access Control using VNET Subnets</a></li><li><a href=#access-control-using-ip-addresses>Access Control using IP Addresses</a></li><li><a href=#exceptions>Exceptions</a><ul><li><a href=#trusted-services>Trusted services</a></li></ul></li></ul></li><li><a href=#the-bigger-picture>The Bigger Picture</a></li><li><a href=#code-sample-configuring-azure-key-vault-network-access>Code Sample: Configuring Azure Key Vault Network Access</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#references>References</a></li></ul></nav></div></div><div class=content id=content><p>In my another <a href=https://robertgrzelka.pl/blog/azure/2023-10-01-azure-private-endpoint/>article</a> we described a Private Endpoints for VNET Integrated Ingress. Today we will talk about Public Network Firewall Access Control from VNET Subnets and IP Addresses.</p><p>In today&rsquo;s digital age, within the vast ecosystem of Azure, security stands out as one of the most pressing concerns for developers and system administrators alike. As organizations increasingly migrate their assets to the cloud, ensuring their protection becomes an absolute necessity. A critical component of this protective infrastructure is the Azure Key Vault. So, how can we guarantee that only the right entities can access it?</p><h2 id=allow-public-network-access-from-all-networks>Allow public network access from all networks</h2><p>By default, Azure Key Vault is designed to be accessible over a public network. In simpler terms, anyone armed with the correct credentials can reach it, regardless of their location. While this offers a high degree of convenience, it may not always be the safest route.</p><p><img loading=lazy src=images/2023-10-07-03-51-22.png srcset="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-51-22.png, images/2023-10-07-03-51-22.png 1.5x, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-51-22.png 2x" sizes=auto data-title=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-51-22.png data-alt=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-51-22.png width=1186 height=330 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h2 id=disable-public-network-access>Disable public network access</h2><p>On the flip side, turning off public network access implies that only those resources which are part of the same VNET (via Private Endpoint described <a href=https://robertgrzelka.pl/blog/azure/2023-10-01-azure-private-endpoint/>here</a>), and optionally, certain &ldquo;trusted&rdquo; Microsoft services, can bypass the firewall to connect with the Key Vault. This option is inherently more secure, but might not be universally applicable ie. during development, resource troubleshooting, etc.</p><p><img loading=lazy src=images/2023-10-07-03-52-04.png srcset="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-52-04.png, images/2023-10-07-03-52-04.png 1.5x, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-52-04.png 2x" sizes=auto data-title=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-52-04.png data-alt=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-52-04.png width=906 height=374 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h2 id=control-public-network-access>Control public network access</h2><p>In this post, we&rsquo;ll delve deep into the mechanisms Azure offers to manage access to the Key Vault over a public network, using firewall rules based on VNET Subnets and specific IP addresses.</p><p><img loading=lazy src=images/2023-10-07-03-56-19.png srcset="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-19.png, images/2023-10-07-03-56-19.png 1.5x, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-19.png 2x" sizes=auto data-title=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-19.png data-alt=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-19.png width=901 height=174 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h3 id=why-control-access>Why Control Access?</h3><p>Before diving into the specifics, it&rsquo;s pivotal to grasp the underlying reasons for these controls on example of Key Vault. Azure Key Vault serves as a secure cloud sanctuary for secrets, keys, and certificates. Any breach or unauthorized access to this vault can jeopardize countless services and data. By narrowing down access to designated VNET subnets or IP addresses, we can drastically shrink the potential threat landscape.</p><h3 id=access-control-using-vnet-subnets>Access Control using VNET Subnets</h3><p>Azure VNET (Virtual Network) provides a secure corridor for Azure resources to interact with each other. Within this VNET, we can carve out a specific subnet and then stipulate that only this designated subnet has the keys to our Key Vault. This ensures an additional security layer, where any resource outside this subnet faces a locked door.</p><p><img loading=lazy src=images/2023-10-07-03-56-41.png srcset="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-41.png, images/2023-10-07-03-56-41.png 1.5x, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-41.png 2x" sizes=auto data-title=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-41.png data-alt=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-41.png width=748 height=265 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h3 id=access-control-using-ip-addresses>Access Control using IP Addresses</h3><p>For situations where resources are located outside of Azure, like a local data center or even another cloud service, and need to tap into the Key Vault, IP-based rules are the way to go. By whitelisting specific IP addresses, we can rest assured that only familiar and trusted entities can access the treasure trove of secrets in the Key Vault.</p><p><img loading=lazy src=images/2023-10-07-03-56-52.png srcset="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-52.png, images/2023-10-07-03-56-52.png 1.5x, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-52.png 2x" sizes=auto data-title=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-52.png data-alt=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-56-52.png width=919 height=192 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h3 id=exceptions>Exceptions</h3><p>Even with these stringent controls, there are certain exceptions that can be made to be aware of, primarily regarding Microsoft trusted services.</p><p><img loading=lazy src=images/2023-10-07-03-57-08.png srcset="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-57-08.png, images/2023-10-07-03-57-08.png 1.5x, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-57-08.png 2x" sizes=auto data-title=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-57-08.png data-alt=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-57-08.png width=909 height=164 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><h4 id=trusted-services>Trusted services</h4><p>REF: <a href=https://learn.microsoft.com/en-us/azure/key-vault/general/overview-vnet-service-endpoints#trusted-services target=_blank rel="external nofollow noopener noreferrer">Virtual network service endpoints for Azure Key Vault<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p><blockquote><p>NOTE: The trusted services list encompasses services where Microsoft controls all of the code that runs on the service. Since users can write custom code in Azure services such as Azure DevOps, Microsoft does not provide the option to create a blanket approval for the service.</p></blockquote><p>Here&rsquo;s a list of trusted services that are allowed to access a key vault if the <strong>Allow trusted services</strong> option is enabled.</p><table><thead><tr><th>Trusted service</th><th>Supported usage scenarios</th></tr></thead><tbody><tr><td>Azure API Management</td><td><a href=../../api-management/api-management-howto-use-managed-service-identity.md#use-ssl-tls-certificate-from-azure-key-vault>Deploy certificates for Custom Domain from Key Vault using MSI</a></td></tr><tr><td>Azure App Service</td><td>App Service is trusted only for <a href=https://azure.github.io/AppService/2016/05/24/Deploying-Azure-Web-App-Certificate-through-Key-Vault.html target=_blank rel="external nofollow noopener noreferrer">Deploying Azure Web App Certificate through Key Vault<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>, for individual app itself, the outbound IPs can be added in Key Vault&rsquo;s IP-based rules</td></tr><tr><td>Azure Application Gateway</td><td><a href=../../application-gateway/key-vault-certs.md>Using Key Vault certificates for HTTPS-enabled listeners</a></td></tr><tr><td>Azure Backup</td><td>Allow backup and restore of relevant keys and secrets during Azure Virtual Machines backup, by using <a href=../../backup/backup-overview.md>Azure Backup</a>.</td></tr><tr><td>Azure Batch</td><td><a href=../../batch/batch-customer-managed-key.md>Configure customer-managed keys for Batch accounts</a> and <a href=../../batch/batch-account-create-portal.md>Key Vault for User Subscription Batch accounts</a></td></tr><tr><td>Azure Bot Service</td><td><a href=https://robertgrzelka.pl/azure/bot-service/bot-service-encryption#grant-azure-bot-service-access-to-a-key-vault>Azure AI Bot Service encryption for data at rest</a></td></tr><tr><td>Azure CDN</td><td><a href="../../cdn/cdn-custom-ssl.md?tabs=option-2-enable-https-with-your-own-certificate#grant-azure-cdn-access-to-your-key-vault">Configure HTTPS on an Azure CDN custom domain: Grant Azure CDN access to your key vault</a></td></tr><tr><td>Azure Container Registry</td><td><a href=../../container-registry/tutorial-enable-customer-managed-keys.md>Registry encryption using customer-managed keys</a></td></tr><tr><td>Azure Data Factory</td><td><a href="https://go.microsoft.com/fwlink/?linkid=2109491" target=_blank rel="external nofollow noopener noreferrer">Fetch data store credentials in Key Vault from Data Factory<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></td></tr><tr><td>Azure Data Lake Store</td><td><a href=../../data-lake-store/data-lake-store-encryption.md>Encryption of data in Azure Data Lake Store</a> with a customer-managed key.</td></tr><tr><td>Azure Database for MySQL</td><td><a href=../../mysql/howto-data-encryption-cli.md>Data encryption for Azure Database for MySQL</a></td></tr><tr><td>Azure Database for PostgreSQL Single server</td><td><a href=../../postgresql/howto-data-encryption-cli.md>Data encryption for Azure Database for PostgreSQL Single server</a></td></tr><tr><td>Azure Database for PostgreSQL Flexible server</td><td><a href=../../postgresql/flexible-server/concepts-data-encryption.md>Data encryption for Azure Database for PostgreSQL Flexible server</a></td></tr><tr><td>Azure Databricks</td><td><a href=https://robertgrzelka.pl/azure/databricks/scenarios/what-is-azure-databricks>Fast, easy, and collaborative Apache Spark–based analytics service</a></td></tr><tr><td>Azure Disk Encryption volume encryption service</td><td>Allow access to BitLocker Key (Windows VM) or DM Passphrase (Linux VM), and Key Encryption Key, during virtual machine deployment. This enables <a href=../../security/fundamentals/encryption-overview.md>Azure Disk Encryption</a>.</td></tr><tr><td>Azure Disk Storage</td><td>When configured with a Disk Encryption Set (DES). For more information, see <a href=../../virtual-machines/disk-encryption.md#customer-managed-keys>Server-side encryption of Azure Disk Storage using customer-managed keys</a>.</td></tr><tr><td>Azure Event Hubs</td><td><a href=../../event-hubs/configure-customer-managed-key.md>Allow access to a key vault for customer-managed keys scenario</a></td></tr><tr><td>Azure Firewall Premium</td><td><a href=../../firewall/premium-certificates.md>Azure Firewall Premium certificates</a></td></tr><tr><td>Azure Front Door Classic</td><td><a href=../../frontdoor/front-door-custom-domain-https.md#prepare-your-key-vault-and-certificate>Using Key Vault certificates for HTTPS</a></td></tr><tr><td>Azure Front Door Standard/Premium</td><td><a href=../../frontdoor/standard-premium/how-to-configure-https-custom-domain.md#prepare-your-key-vault-and-certificate>Using Key Vault certificates for HTTPS</a></td></tr><tr><td>Azure Import/Export</td><td><a href=../../import-export/storage-import-export-encryption-key-portal.md>Use customer-managed keys in Azure Key Vault for Import/Export service</a></td></tr><tr><td>Azure Information Protection</td><td>Allow access to tenant key for <a href=https://robertgrzelka.pl/azure/information-protection/what-is-information-protection>Azure Information Protection.</a></td></tr><tr><td>Azure Machine Learning</td><td><a href=../../machine-learning/how-to-secure-workspace-vnet.md>Secure Azure Machine Learning in a virtual network</a></td></tr><tr><td>Azure Resource Manager template deployment service</td><td><a href=../../azure-resource-manager/templates/key-vault-parameter.md>Pass secure values during deployment</a>.</td></tr><tr><td>Azure Service Bus</td><td><a href=../../service-bus-messaging/configure-customer-managed-key.md>Allow access to a key vault for customer-managed keys scenario</a></td></tr><tr><td>Azure SQL Database</td><td><a href=https://robertgrzelka.pl/azure/azure-sql/database/transparent-data-encryption-byok-overview>Transparent Data Encryption with Bring Your Own Key support for Azure SQL Database and Azure Synapse Analytics</a>.</td></tr><tr><td>Azure Storage</td><td><a href=../../storage/common/customer-managed-keys-configure-key-vault.md>Storage Service Encryption using customer-managed keys in Azure Key Vault</a>.</td></tr><tr><td>Azure Synapse Analytics</td><td><a href=../../synapse-analytics/security/workspaces-encryption.md>Encryption of data using customer-managed keys in Azure Key Vault</a></td></tr><tr><td>Azure Virtual Machines deployment service</td><td><a href=https://robertgrzelka.pl/archive/blogs/kv/updated-deploy-certificates-to-vms-from-customer-managed-key-vault>Deploy certificates to VMs from customer-managed Key Vault</a>.</td></tr><tr><td>Exchange Online, SharePoint Online, M365DataAtRestEncryption</td><td>Allow access to customer managed keys for Data-At-Rest Encryption with <a href="https://robertgrzelka.pl/microsoft-365/compliance/customer-key-overview?view=o365-worldwide&amp;preserve-view=true">Customer Key</a>.</td></tr><tr><td>Microsoft Purview</td><td><a href=../../purview/manage-credentials.md>Using credentials for source authentication in Microsoft Purview</a></td></tr></tbody></table><h2 id=the-bigger-picture>The Bigger Picture</h2><p><img loading=lazy src=images/2023-10-07-03-42-53.png srcset="https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-42-53.png, images/2023-10-07-03-42-53.png 1.5x, https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-42-53.png 2x" sizes=auto data-title=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-42-53.png data-alt=/blog/azure/azure-public-network-firewall-access-control/images/2023-10-07-03-42-53.png width=1657 height=870 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></p><p>By intertwining VNET Subnet and IP Address-based rules, Azure furnishes a formidable mechanism to shield your Key Vaults. It not only meshes effortlessly with other Azure offerings but also bestows granular control, addressing both broad and niche requirements.</p><h2 id=code-sample-configuring-azure-key-vault-network-access>Code Sample: Configuring Azure Key Vault Network Access</h2><p>When working with Azure infrastructure, Infrastructure as Code (IaC) often becomes the preferred approach, allowing for the reliable and repeatable deployment of resources. Using Terraform, one of the popular IaC tools, we can define and provision our Azure Key Vault along with its network access controls.</p><p>Below is a Terraform code snippet that showcases how to set up an Azure Key Vault with specific network access controls:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-tf data-lang=tf><span class=line><span class=cl><span class=c1>## Create Azure Key Vault with specified configuration.
</span></span></span><span class=line><span class=cl><span class=c1>##
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>resource</span> <span class=s2>&#34;azurerm_key_vault&#34;</span> <span class=s2>&#34;this&#34;</span> <span class=p>{</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  ## The final name is constructed using a prefix, &#39;kv&#39;, and a suffix.
</span></span></span><span class=line><span class=cl><span class=c1>  ##
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=na>name</span>                     = <span class=s2>&#34;</span><span class=si>${</span><span class=nb>var</span><span class=p>.</span><span class=nx>prefix</span><span class=si>}</span><span class=s2>kv</span><span class=si>${</span><span class=nb>var</span><span class=p>.</span><span class=nx>suffix</span><span class=si>}</span><span class=s2>&#34;</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  ## The Azure region where the Key Vault will be created.
</span></span></span><span class=line><span class=cl><span class=c1>  ##
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=na>location</span>                 = <span class=nb>var</span><span class=p>.</span><span class=nx>location</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  ## The Azure Resource Group under which the Key Vault will reside.
</span></span></span><span class=line><span class=cl><span class=c1>  ##
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=na>resource_group_name</span>      = <span class=nb>var</span><span class=p>.</span><span class=nx>resource_group_name</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  ## The Azure Active Directory Tenant ID that will be associated with this Key Vault.
</span></span></span><span class=line><span class=cl><span class=c1>  ##
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=na>tenant_id</span>                = <span class=nb>var</span><span class=p>.</span><span class=nx>tenant_id</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  ## The SKU (pricing tier) for the Key Vault. In this case, it&#39;s set to &#34;standard&#34;.
</span></span></span><span class=line><span class=cl><span class=c1>  ##
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=na>sku_name</span>                 = <span class=s2>&#34;standard&#34;</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>  ## Network Access Control Lists (ACLs) define who can access the Key Vault.
</span></span></span><span class=line><span class=cl><span class=c1>  ##
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>network_acls</span> <span class=p>{</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>    ## By default, all requests are denied.
</span></span></span><span class=line><span class=cl><span class=c1>    ##
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=na>default_action</span>             = <span class=s2>&#34;Deny&#34;</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>    ## However, Trusted Microsoft services are allowed to bypass this default rule.
</span></span></span><span class=line><span class=cl><span class=c1>    ##
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=na>bypass</span>                     = <span class=s2>&#34;AzureServices&#34;</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>    ## Only the specified virtual network&#39;s subnet can access this Key Vault.
</span></span></span><span class=line><span class=cl><span class=c1>    ##
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=na>virtual_network_subnet_ids</span> = <span class=p>[</span><span class=nx>azurerm_subnet</span><span class=p>.</span><span class=nx>this</span><span class=p>.</span><span class=nx>id</span><span class=p>]</span><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>
</span></span></span><span class=line><span class=cl><span class=c1>    ## Apart from the subnet, only the specified IP addresses can access the Key Vault.
</span></span></span><span class=line><span class=cl><span class=c1>    ##
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=na>ip_rules</span>                   = <span class=nb>var</span><span class=p>.</span><span class=nx>ip_list</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=conclusion>Conclusion</h2><p>Security in the cloud is a shared responsibility. While Azure provides the tools and services, it&rsquo;s up to us to utilize them effectively. By understanding and implementing access control on our Key Vaults, we&rsquo;re not just securing our data, but we&rsquo;re also ensuring the smooth operation of our services by preventing any unauthorized or malicious access.</p><h2 id=references>References</h2><p><a href="https://learn.microsoft.com/en-us/azure/key-vault/general/network-security?WT.mc_id=Portal-Microsoft_Azure_KeyVault" target=_blank rel="external nofollow noopener noreferrer">Configure Azure Key Vault firewalls and virtual networks - Azure Key Vault<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Updated on 2023-10-08 15:58:25">Updated on 2023-10-08&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/index.md title="Read Markdown" class=link-to-markdown>Read Markdown</a></span><span><a href=https://github.com/ralf-it/robertgrzelka.pl/edit/main/content/blog/azure/azure-public-network-firewall-access-control/index.en.md title="Edit this page" target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>Edit this page</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/ data-title="Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses" data-via=xxxx data-hashtags="Azure,VNET,Subnet,IP Address,Public Network Access,Firewall,DevOps,Key Vault"><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/ data-hashtag=Azure><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/><i class="fa-brands fa-linkedin fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/ data-title="Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/ data-title="Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses"><i data-svg-src=https://robertgrzelka.pl/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://robertgrzelka.pl/blog/azure/azure-public-network-firewall-access-control/ data-title="Azure Public Network Firewall Access Control from VNET Subnets and IP Addresses"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=https://robertgrzelka.pl/tags/azure/ class=post-tag>Azure</a><a href=https://robertgrzelka.pl/tags/vnet/ class=post-tag>VNet</a><a href=https://robertgrzelka.pl/tags/subnet/ class=post-tag>Subnet</a><a href=https://robertgrzelka.pl/tags/ip-address/ class=post-tag>IP Address</a><a href=https://robertgrzelka.pl/tags/public-network-access/ class=post-tag>Public Network Access</a><a href=https://robertgrzelka.pl/tags/firewall/ class=post-tag>Firewall</a><a href=https://robertgrzelka.pl/tags/devops/ class=post-tag>DevOps</a><a href=https://robertgrzelka.pl/tags/key-vault/ class=post-tag>Key Vault</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=https://robertgrzelka.pl/>Home</a></span></section></div><div class=post-nav><a href=https://robertgrzelka.pl/blog/azure/azure-private-endpoint/ class=post-nav-item rel=prev title="Azure Private Endpoints for VNET Integrated Ingress"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Azure Private Endpoints for VNET Integrated Ingress</a>
<a href=https://robertgrzelka.pl/blog/azure/azure-devops-variables/ class=post-nav-item rel=next title="Azure DevOps Pipeline Variable Types - Compile-time, Queue-time, and Run-time">Azure DevOps Pipeline Variable Types - Compile-time, Queue-time, and Run-time<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus><script src=https://giscus.app/client.js data-repo=ralf-it/robertgrzelka.pl data-repo-id=R_kgDOGihPtQ data-category=General data-category-id=DIC_kwDOGihPtc4CApHX data-mapping=title data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=en data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class="footer-line powered">Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.118.2">Hugo</a> | Theme - <a href=https://github.com/ralf-it/hugo-ralf-it target=_blank rel=external title="RALF-IT v0.2.18"><img class=ralf-it-icon src=https://robertgrzelka.pl/ralf-it.min.svg alt="RALF-IT logo">&nbsp;RALF-IT</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2021 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=https://robertgrzelka.pl target=_blank rel="external nofollow noopener noreferrer">Robert Grzelka</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title='Website running ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">Website running ...</span></span></div><div class="footer-line visitor"><span id=busuanzi_container_site_uv title='Total visitors'><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title='Total visits'><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label="View Comments"><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/ralf-it/hugo-ralf-it title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>Theme RALF-IT works best with JavaScript enabled.</div></noscript></div><link rel=stylesheet href=https://robertgrzelka.pl/lib/lightgallery/css/lightgallery-bundle.min.120f067ebd6f322339e2ccccd7e87e334d7c7ea5b2bd553f325f2ae3c3ae6fe8.css integrity="sha256-Eg8Gfr1vMiM54szM1+h+M018fqWyvVU/Ml8q48Oub+g="><link rel=stylesheet href=https://robertgrzelka.pl/lib/cookieconsent/cookieconsent.min.cd0d0b6e50ff01ff2f3a9a70d7cfb66a7c6cb9acf7a566325568be6d3bd31fc4.css integrity="sha256-zQ0LblD/Af8vOppw18+2anxsuaz3pWYyVWi+bTvTH8Q="><link rel=stylesheet href=https://robertgrzelka.pl/lib/pace/themes/blue/pace-theme-minimal.3e16fae4203c52d34839f9d15c349407478e6a49eaf8cbaad7e258f019b7ccae.css integrity="sha256-Phb65CA8UtNIOfnRXDSUB0eOaknq+Muq1+JY8Bm3zK4="><script src=https://robertgrzelka.pl/lib/autocomplete/autocomplete.min.ae2da1bd62c6469ee27770ad1cddf2e8296d8a7f6d85b091463e5200c5e320af.js integrity="sha256-ri2hvWLGRp7id3CtHN3y6Cltin9thbCRRj5SAMXjIK8=" defer></script><script src=https://robertgrzelka.pl/lib/algoliasearch/algoliasearch-lite.umd.min.6967a37fd7ef3676c81376993b3a6583dcb7d378478e6e2975c4fc682edeb1d5.js integrity="sha256-aWejf9fvNnbIE3aZOzplg9y303hHjm4pdcT8aC7esdU=" defer></script><script src=https://robertgrzelka.pl/lib/instant-page/instantpage.min.f275af85c0e0dee6a46ed2867180f0f9a0f9cb9a4b9a74e3814fced569ef163d.js integrity="sha256-8nWvhcDg3uakbtKGcYDw+aD5y5pLmnTjgU/O1WnvFj0=" async defer type=module></script><script src=https://robertgrzelka.pl/lib/twemoji/twemoji.min.706224d8dc5440460f8ed91c1a6aad25d732af6e0ee6fb31151b157ab485babb.js integrity="sha256-cGIk2NxUQEYPjtkcGmqtJdcyr24O5vsxFRsVerSFurs=" defer></script><script src=https://robertgrzelka.pl/lib/lightgallery/lightgallery.min.a109d6550e0f5c7f5ad89c835407ceb18ed48d1e50d6d9b6c37234d5ee7ebaa8.js integrity="sha256-oQnWVQ4PXH9a2JyDVAfOsY7UjR5Q1tm2w3I01e5+uqg=" defer></script><script src=https://robertgrzelka.pl/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.baa7d26c390a254160ee3ae0f09a9a16c77d1a5b4b6853c5e4487de764fee24b.js integrity="sha256-uqfSbDkKJUFg7jrg8JqaFsd9GltLaFPF5Eh952T+4ks=" defer></script><script src=https://robertgrzelka.pl/lib/lightgallery/plugins/zoom/lg-zoom.min.056f82747a5949da14472c62a803167ecbdc3f847fc44755e5b33ec7f1319f02.js integrity="sha256-BW+CdHpZSdoURyxiqAMWfsvcP4R/xEdV5bM+x/ExnwI=" defer></script><script src=https://robertgrzelka.pl/lib/sharer/sharer.min.ba5171a78670b031914e623431a33a3d73c1ea9897e552ba73bc2c2da7c777b9.js integrity="sha256-ulFxp4ZwsDGRTmI0MaM6PXPB6piX5VK6c7wsLafHd7k=" async defer></script><script src=https://robertgrzelka.pl/lib/typeit/index.umd.16f3fa3374a7eea31f19672293edc98326413002dea74b8c413a74f1b7e4f1cf.js integrity="sha256-FvP6M3Sn7qMfGWcik+3JgyZBMALep0uMQTp08bfk8c8=" defer></script><script src=https://robertgrzelka.pl/lib/cookieconsent/cookieconsent.min.e55842a856a6d829feca3c3ad736c136b6c7549e9247274f78aa296259e06e24.js integrity="sha256-5VhCqFam2Cn+yjw61zbBNrbHVJ6SRydPeKopYlngbiQ=" defer></script><script src=https://robertgrzelka.pl/lib/cell-watermark/watermark.min.8518c89a43d8bcbcf981bbd3d6364ce91a5142b15e0e584e2a39dc36661d6b13.js integrity="sha256-hRjImkPYvLz5gbvT1jZM6RpRQrFeDlhOKjncNmYdaxM=" defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script src=https://robertgrzelka.pl/lib/pace/pace.min.82a77b6138e0fc1b5fa964b0b093af9dd97407173c8052262c4917413f3eaa3d.js integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" async defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"Copy to clipboard",editLockTitle:"Lock editable code block",editUnLockTitle:"Unlock editable code block",editable:!0,maxShownLines:10},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark_dimmed",lightTheme:"light"}},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},data:{"typeit-profile-subtitle":"Building Bridges in the Digital Realm: Where Code Meets Infrastructure"},enablePWA:!0,lightgallery:!0,search:{algoliaAppID:"YKOM6PKLUY",algoliaIndex:"index.en",algoliaSearchKey:"a44c110d3ac360be2c69cd79d34b77a8",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"},siteTime:"2021-12-18T16:15:22+08:00",twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"typeit-profile-subtitle":["typeit-profile-subtitle"]},duration:-1,loop:!1,speed:100},watermark:{appendto:".wrapper>main",colspacing:30,content:"",enable:!0,fontfamily:"inherit",fontsize:.85,height:21,opacity:.0125,rotate:15,rowspacing:60,width:150}}</script><script src=https://robertgrzelka.pl/js/theme.min.3c39fd0460bb82ac0496cb3c81996b62c8854c8d6b482249987076178efff875.js integrity="sha256-PDn9BGC7gqwElss8gZlrYsiFTI1rSCJJmHB2F47/+HU=" defer></script><script src=https://robertgrzelka.pl/js/custom.min.4b54d853af10f69ba3fb09f3eef291def48696d65f9ce87137612eaa201d5349.js integrity="sha256-S1TYU68Q9puj+wnz7vKR3vSGltZfnOhxN2EuqiAdU0k=" defer></script></body></html>